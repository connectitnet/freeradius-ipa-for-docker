authorize {
    filter_username
    preprocess
    #chap
    #mschap
    suffix
    #eap {
    #    ok = return
    #}
    ldap
    expiration
    logintime
    pap
}
authenticate {
    Auth-Type PAP {
            pap
    }
    Auth-Type CHAP {
            chap
    }
    Auth-Type MS-CHAP {
            mschap
    }
    Auth-Type LDAP {
            ldap
    }
    eap
}
preacct {
    preprocess
    acct_unique
    suffix
}
accounting {
    detail
    if (noop) {
        ok
    }
    exec
    attr_filter.accounting_response
}
session {
        radutmp
}
post-auth {
    ldap
    exec
    update reply {
        Reply-Message += "%{TLS-Cert-Serial}"
        Reply-Message += "%{TLS-Cert-Expiration}"
        Reply-Message += "%{TLS-Cert-Subject}"
        Reply-Message += "%{TLS-Cert-Issuer}"
        Reply-Message += "%{TLS-Cert-Common-Name}"
        Reply-Message += "%{TLS-Cert-Subject-Alt-Name-Email}"

        Reply-Message += "%{TLS-Client-Cert-Serial}"
        Reply-Message += "%{TLS-Client-Cert-Expiration}"
        Reply-Message += "%{TLS-Client-Cert-Subject}"
        Reply-Message += "%{TLS-Client-Cert-Issuer}"
        Reply-Message += "%{TLS-Client-Cert-Common-Name}"
        Reply-Message += "%{TLS-Client-Cert-Subject-Alt-Name-Email}"
    }
    Post-Auth-Type REJECT {
        ldap
        eap
    }
}
pre-proxy {
}
post-proxy {
}